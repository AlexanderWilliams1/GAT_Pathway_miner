## Usage
1. Prepare your data:
   - Gene expression matrix (TSV format, genes Ã— samples)
   - Prior network edges (CSV with 'source' and 'target' columns)

2. Update file paths in `GAT2.4.py`:
```python
df_tcga = pd.read_csv('/path/to/your/expression_data.tsv', sep='\t', index_col=0)
net_df = pd.read_csv('/path/to/your/network_edges.csv')
```

3. Run the complete pipeline:
```bash
python GAT2.4.py
```

## Output Files
- **5fold_cv_results.csv**: Performance metrics for each fold
- **Predicted_novel_edges_top20.csv**: Top 20 predicted novel interactions with confidence scores
- Console output includes:
  - Network statistics (size, density, imbalance ratio)
  - Hyperparameter optimization results
  - Cross-validation summary
  - Score distribution of top predictions

## Performance Metrics
- **AUROC**: Area Under Receiver Operating Characteristic Curve
- **AUPRC**: Area Under Precision-Recall Curve (primary optimization target)
- **Precision@100**: Precision of top 100 predictions

## Hyperparameter Search Space
- Hidden channels: {32, 64}
- Output channels: {16, 32}
- Attention heads: {2, 3}
- Learning rate: 1e-4 to 1e-2 (log scale)
- Dropout: 0.4 to 0.5
- Weight decay: 1e-3 to 1e-2 (log scale)

## Dataset Requirements
- **Expression Data**: Normalized gene expression matrix
- **Prior Network**: Known TF-target interactions (can be sparse)
- **Nodes**: Should match between expression data and network

## Technical Notes
- **Random Seeds**: Fixed for reproducibility
- **Early Stopping**: Patience of 15-20 epochs based on validation AUPRC
- **Negative Sampling**: 2:1 negative:positive ratio to reflect biological network sparsity
- **Disjoint Edges**: 30% of training edges used only for supervision, not message passing

## Applications
- Discovery of novel gene regulatory interactions
- Extension of known biological pathways
- Prioritization of edges for experimental validation
- Network-based biomarker discovery

## Citation
If you use this code, please cite:
- GATv2: Brody et al., "How Attentive are Graph Attention Networks?" ICLR 2022
- Optuna: Akiba et al., "Optuna: A Next-generation Hyperparameter Optimization Framework" KDD 2019
- Relevant biological data sources

## License
[Specify your license here, e.g., MIT License]

